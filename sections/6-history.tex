\chapter{History of fully homomorphic encryption}

The history of homomorphic encryption began with Rivest, Adleman and Dertouzos \cite{rivest1978} already in 1978 where they identified the use of delegating computation to a third party. They were not successful in constructing a secure scheme that supports both multiplication and addition of ciphertext, as required for arbitrary function evaluation. The problem of finding a secure scheme that supports both operations turned out to be difficult and remained unsolved for more than 30 years. Interestingly, multiple secure scheme that supports either multiplication or addition of ciphertexts were discovered. For example, the RSA scheme supports multiplication of ciphertexts and the Paillier scheme supports addition of ciphertexts. It was not until 2009, when Craig Gentry published his PhD thesis \cite{Gentry-Thesis}, that a fully homomorphic encryption scheme was first constructed. Gentry's original scheme was inefficient and since then, many improved schemes have been introduced, both in terms of efficiency and security. In this chapter, we will go through the history of fully homomorphic encryption, split into four generations.

\section{First generation}
Gentry scheme is based on ideal lattices. The construction considers a polynomial ring over the integers modulo an ideal generated by a cyclotomic polynomial, similar to the $\operatorname{RLWE}$ setup. Then, there exists an ideal with norm polynomially bounded with respect to the dimension such that the ideal generates a lattice (see \cite{Gentry-Thesis} for details). The security of Gentry's scheme was based on three hardness assumptions: sparse subset-sum problem (SSSP), bounded-distance decoding problem (BDD) and the ideal shortest vector problem (ideal-SVP). The original decryption function in Gentry's scheme was not bootstrappable (see definition \ref{def:bootstrappable}), without the use of a method he introduced, called squashing. The idea was to include extra information in the public key which allowed for easier decryption, which meant that security also required the SSSP hardness assumption.

The Gentry's scheme was improved by Smart and Vercauteren in \cite{SV09-batch} where they introduced batching of multiple plaintexts encrypted into a single ciphertext using the Chinese Remainder Theorem (ciphertext packing is the same idea where multiple ciphertexts are packed together). Gentry and Halevi implemented the scheme in \cite{GS10-impl}, including the use of the batching technique and an optimized squashing technique to bring down the degree of the decryption polynomial from hundreds (estimated by Smart and Vercauteren) to 15. In Gentry's original scheme, the key generation algorithm was impractically slow. In their implementation, they reduced the asymptotic complexity to $\tilde{O}\left(n^{1.5}\right)$ for cyclotomic fields where the order of the root of unity is a power of 2 (i.e., $\mathbb{Z}[x] /\langle x^{n} + 1\rangle$ for $n = 2^k$). Scholl and Smart extended the implementation to arbitrary cyclotomic fields in \cite{SS11-keygen}.

In 2010, Marten van Dijk, Craig Gentry, Shai Halevi, and Vinod Vaikuntanathan finalized a new scheme (DGHV scheme) that was based on multiplication and addition over the integers as opposed to over polynomial rings \cite{DGHV10}. The hardness of the DGHV scheme was based on the approximate greatest common divisor problem (AGCD), and the SSSP due to squashing of the decryption circuit. Subsequent works optimized the DGHV scheme through modulus switching in \cite{DGHV-modswitch} and plaintext batching in \cite{DGHV-batch1} and \cite{DGHV-batch2}.

\section{Second generation}
The second generation began in 2011 with Brakerski and Vaikuntanathan \cite{BV11}. Their paper introduced two main contributions. Their first contribution was to base the hardness of the proposed BV scheme on the well known LWE problem, which means using arbitrary lattices instead of ideal lattices. Their second contribution was the removal of squashing from previous schemes (Gentry and Halevi, independently, also managed to remove squashing in \cite{Gen-Hal-no-squash}). This meant that the BV scheme did not require the SSSP hardness assumption. As an optimization technique, the paper was the first to introduce what would later be called \emph{modulus switching}. Modulus switching is an alternative to Bootstrapping in managing noise growth (see Chapter \ref{chp:noise}) by scaling down the ciphertext noise and the global modulus, effectively switching the modulus of the scheme. Modulus switching keeps the ratio of noise to modulus the same but is still effective since the magnitude of the noise, and thus also its growth rate, is smaller. A downside of the BV scheme (and the rest of the schemes based on LWE in the second generation) was that an expensive step called re-linearization is necessary to prevent homomorphic multiplication causing ciphertext length from growing exponentially. In the BV scheme, homomorphic multiplication corresponds to a tensor product, changing the structure of the ciphertext. In order to re-linearize the result, the scheme uses key-switching. This requires applying a large re-linearization matrix of size $\Omega(n^3)$ (embedded in the public key) to the tensorproduct.

In a follow up paper in 2011, Brakerski, Gentry and Vaikuntanathan introduced the BGV scheme that showed, for the first time, bootstrapping was not necessary for a fully homomorphic encryption scheme. Their construction worked for both LWE and RLWE, and ironically used bootstrapping as an optimization technique. Brakerski later modified the LWE based BGV scheme by replacing the modulus switching technique with a similar \emph{scale invariant} approach \cite{Bra12-BFV}. The idea was to scale down the ciphertext by the constant global modulus $q$, thus reducing the noise bound $\beta < q$ to a corresponding fraction, mod 1. Brakerski showed that noise growth for scale invariant ciphertexts under homomorphic multiplication only grows polynomially w.r.t dimension $n$ (and hence security parameter). Fan and Vercauteren converted Brakerski's scale invariant scheme to the RLWE setting, resulting in the BFV scheme \cite{FV12-BFV}. It is worth mentioning that as a part of the second generation of homomorphic encryption, there were schemes based on the NTRU public key encryption scheme from 1998 \cite{NTRU}. However, these schemes required parameter sizes larger than originally proposed due to vulnerabilities from subfield lattice attacks \cite{NTRU-attack}.

\section{Third generation}
In 2013, Gentry, Sahai and Waters introduced a new scheme called the GSW scheme \cite{GSW13}. The GSW scheme was also based on LWE, but unlike its predecessors, it did not require the re-linearization step. This is because the scheme operates on matrices which has an inherent natural addition and multiplication operation. Since the relinearization matrix is no longer needed, the space complexity of GSW is quasi-quadratic as opposed to quasi-cubic for BGV and BFV. Furthermore, GSW also did not require bootstrapping to achieve FHE. A downside of the GSW scheme is the complexity of ciphertext matrix multiplication, yielding in slower multiplication than the ring based second generation schemes.

A defining trait of the third generation is the efficiency gain from bootstrapping. There were two main new faster bootstrapping algorithms. Jacob Alperin-Sheriff and Chris Peikert \cite{A-S-P-boot} introduced bootstrapping of non-packed ciphertexts in quasilinear time w.r.t the security parameter (which is important in the third generation as there is no packing) and Gama et al. \cite{Gama-boot} built on their work and introduced a new type of homomorphic gate. LÃ©o Ducas and Daniele Micciancio developed a scheme called FHEW that used Alperin-Sheriff and Peikerts bootstrapping algorithm to allow for much faster bootstrapping using what is now called programmable bootstrapping \cite{FHEW}. Another paper introuced a scheme based on the LWE over the torus, meaning a stricter security assumption, called TFHE \cite{TFHE} which allowed for bootstrapping in 0.1 milliseconds after subsequent optimizations \cite{MP-fhew-tfhe}.

\section{Fourth generation}
The fourth generation of homomorphic encryption schemes began in 2016 when Jung Hee Cheon, Andrey Kim, Miran Kim and Yongsoo Song introduced a new RLWE based leveled FHE scheme called CKKS \cite{CKKS16} which they subsequently turned into a pure FHE scheme through bootstrapping in \cite{CKKS-boot}. CKKS is based on approximate arithmetic, allowing for computation on real and complex numbers. To achieve this, a vector of numbers (real or complex) are encoded using rounding as a integral plaintext polynomial in a cyclotomic polynomial ring. This is a fundamentally different approach as the scheme operates on an approximation of the message as opposed to the real message. The CKKS scheme is useful for applications concerning floating point numbers, such as machine learning and neural networks. Subsequent works focused on optimizing the bootstrapping and ciphertext packing techniques.

In 2020, Baiyu Li and Daniele Micciancio showed that the CKKS scheme was vulnerable to passive attacks with respect to IND-CPA security \cite{CKKS-attack}. To mitigate this issue, a new security notion called IND-CPA+ was introduced. IND-CPA+ and IND-CCA1 differ in that the adversary is only allowed to query decryption on evaluated ciphertexts, as opposed to arbitrary ciphertexts. Li and Micciancio showed that IND-CPA+ is eequivalent to IND-CPA for exact encryption schemes but strictly stronger for approximate schemes like CKKS. 
